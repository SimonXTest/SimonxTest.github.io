# Installing OpenWRT Into my Network, with TinyProxy, VPN, And Pi-Hole.

I replaced the stock firmware from my router with OpenWRT, this provides me a lot more control over my router, and allows me to learn more about managing a network.

The first thing I did was perform dns hijacking against myself. This is because applications were able to bypass my Pi-Hole local dns resolver. Pi-Hole is a local dns resolver that provides security and a better browsing experience to all my devices in my network. Being able to bypass my dns resolver allows bad actors to perform dns hijacking attacks, and send requests that are meant to be blocked in my network. The requests blocked by my Pi-Hole device are malware, tracking from websites I am not familiar with, and advertisements. To perform dns hijacking, I had to make sure that every request sent from port 53 (the port used for dns requests) is instead forwarded by my router to my local dns. I also had to prohibit dns over https addresses in my network, since those don't use port 53 and are able to bypass my dns. There is a guide on the openwrt forums on how to do this here [https://openwrt.org/docs/guide-user/firewall/fw3_configurations/intercept_dns](https://openwrt.org/docs/guide-user/firewall/fw3_configurations/intercept_dns)

I also wanted to have a vpn on my router. This helps prevent leaks, from malfunction or an application trying to bypass it. I created a separate network on openwrt, to not force everyone to be connected to my vpn. I had a problem with my vpn network being too slow to resolve addresses. To solve this I had to connect my dns resolver to the new network, change firewall rules to allow input between both networks, and perform dns hijacking on the new network. Tinyproxy was also installed to allow only some apps to bypass my vpn (example: online banking applications and websites)

I might make an image that shows how my network structure looks like. It would not be relevant in any way, but it would still be good filler image.
